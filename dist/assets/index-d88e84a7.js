import{b as P,u as D,r as a,j as e}from"./index-4dcbfe16.js";import{P as b}from"./index-91dbd293.js";import{s as S}from"./styles-e7ca6728.js";import{S as v}from"./SpinLoader-78ef40b6.js";import{w as p}from"./index-69a0fb70.js";import{E as N}from"./index-b4b753a9.js";import"./index-a290fad1.js";const u="http://localhost:5000/api/v1",I=()=>{const i=P().id,m=D(),[h,f]=a.useState(!0),[l,g]=a.useState(null),[j,y]=a.useState({question:"",description:"",optionList:[],endDate:""}),E=async({question:s,description:r,optionList:t,endDate:n})=>{let x=s,w=t.map(o=>({subject:o}));try{const d=await(await fetch(`${u}/poll/updatePoll/${i}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({title:x,description:r,options:w,endDate:n})})).json();if(d.success)p.success("Your poll has been Updated successfully"),m(-1);else throw new Error(d.message)}catch(o){console.log("Error during editing your poll",o),p.error("Error updatin poll")}},c=async()=>{try{const r=await(await fetch(`${u}/poll/getPoll/${i}`)).json();if(r.success){const t=r.poll;y({question:t.title,description:t.description,optionList:t.options.map(n=>n.subject),endDate:new Date(t.endDate)})}else throw new Error(r.message)}catch(s){console.log("Error getting your poll",s),g(s.message)}finally{f(!1)}};return a.useEffect(()=>{c()},[i]),l?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(N,{heading:"Error fetching the dashoard",message:l,action:c})}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:`${S.heading2} mb-6`,children:"Create Free Poll With PollLab"}),h?e.jsx("div",{className:"flex justify-center",children:e.jsx(v,{})}):e.jsx(b,{handleSubmit:E,initialData:j,reset:!0,type:"Edit"})]})};export{I as default};
