import{b as P,u as D,r as a,j as e}from"./index-4f8d315e.js";import{P as b}from"./index-7e383de1.js";import{s as S}from"./styles-0ca58f2b.js";import{S as v}from"./SpinLoader-1c504879.js";import{w as p}from"./index-44c1b41b.js";import{E as N}from"./index-94e5c423.js";import"./index-2fec4983.js";const m="https://mern-polling.onrender.com/api/v1",I=()=>{const n=P().id,u=D(),[f,h]=a.useState(!0),[l,g]=a.useState(null),[j,y]=a.useState({question:"",description:"",optionList:[],endDate:""}),E=async({question:s,description:r,optionList:t,endDate:i})=>{let x=s,w=t.map(o=>({subject:o}));try{const d=await(await fetch(`${m}/poll/updatePoll/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({title:x,description:r,options:w,endDate:i})})).json();if(d.success)p.success("Your poll has been Updated successfully"),u(-1);else throw new Error(d.message)}catch(o){console.log("Error during editing your poll",o),p.error("Error updatin poll")}},c=async()=>{try{const r=await(await fetch(`${m}/poll/getPoll/${n}`)).json();if(r.success){const t=r.poll;y({question:t.title,description:t.description,optionList:t.options.map(i=>i.subject),endDate:new Date(t.endDate)})}else throw new Error(r.message)}catch(s){console.log("Error getting your poll",s),g(s.message)}finally{h(!1)}};return a.useEffect(()=>{c()},[n]),l?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(N,{heading:"Error fetching the dashoard",message:l,action:c})}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:`${S.heading2} mb-6`,children:"Create Free Poll With PollLab"}),f?e.jsx("div",{className:"flex justify-center",children:e.jsx(v,{})}):e.jsx(b,{handleSubmit:E,initialData:j,reset:!0,type:"Edit"})]})};export{I as default};
