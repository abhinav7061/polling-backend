import{u as P,r as a,U as C,b as S,j as e}from"./index-4c064340.js";import{C as u,p as D,i as x,d as f,v as M}from"./index-348216db.js";import{s as T}from"./styles-12bc90a9.js";import{S as g}from"./SpinLoader-16bc32d2.js";import{F as U,a as V}from"./index-796ce31e.js";import{w as $}from"./index-bff4b79e.js";import{E as F}from"./index-ddf156a2.js";import"./FollowersContext-3cc64a2a.js";import"./index-49d39018.js";import"./TransitionGroup-893ef530.js";const p="https://mern-polling.onrender.com/api/v1",B=()=>{const h=P(),{userInfo:w}=a.useContext(C),o=S().id,[j,i]=a.useState(!0),[t,v]=a.useState(null),[y,c]=a.useState(!0),[l,b]=a.useState(null),[d,n]=a.useState(null),N=async()=>{n(null),i(!0);try{const s=await fetch(`${p}/user/${o}`,{credentials:"include"}),r=await s.json();if(r.success&&s.ok)b(r.user);else throw new Error((r==null?void 0:r.message)||"Server Error")}catch(s){console.log("Error: ",s),n(s.message)}finally{i(!1)}},m=async()=>{n(null),c(!0);try{const s=await fetch(`${p}/user/dashboard/${o}`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}),r=await s.json();if(s.ok)v(r);else throw new Error((r==null?void 0:r.message)||"Server Error")}catch(s){console.log("Error while getting your dashboard",s),n(s.message)}finally{c(!1)}},E=()=>{$.warning("You are not allowed to change this data.")};return a.useEffect(()=>{window.scrollTo(0,0),w._id==o&&h("/poll/my_profile"),N(),m()},[o]),d?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(F,{heading:"Error fetching the dashoard",message:d,action:m})}):j?e.jsx("div",{className:"absolute w-full h-full z-10 flex justify-center items-center",children:e.jsx(g,{})}):e.jsxs("div",{className:"pt-10 sm:pt-0 px-3 sm:px-0",children:[e.jsxs("div",{className:"flex justify-around items-center flex-col xl:flex-row",children:[e.jsxs("div",{className:"rounded-3xl bg-white sm:p-6 p-3 flex flex-col items-center w-full xl:w-2/3",children:[e.jsx("div",{className:"rounded-xl border-[2px]  border-dashed border-stone-300 p-3 flex items-center gap-2",children:e.jsx("div",{className:"relative flex justify-center items-center group rounded-full h-48 w-48 overflow-hidden ",children:e.jsx("img",{src:l.avatar.url,alt:"Profile pic",className:"transition-opacity duration-300  object-top object-cover  h-48 w-48"})})}),e.jsxs("div",{className:"flex items-center justify-center flex-wrap gap-x-10 my-5 relative",children:[e.jsx("h1",{className:`font-bold whitespace-nowrap ${T.heading4}`,children:l.name}),e.jsx("textarea",{type:"text",value:l.myStatus,className:"outline-none text-[12px] lg:text-[16px] flex-grow resize-none py-1 rounded-md border-2 border-transparent focus:border-slate-500 lg:px-3 sm:px-1 text-center",onChange:E,disabled:!0})]})]}),y?e.jsx(g,{}):e.jsxs("div",{className:"xl:ml-5 items-center gap-6 md:gap-8 mt-8 xl:mt-0 flex flex-col lg:flex-row w-full xl:flex-col xl:w-auto",children:[e.jsx(u,{img:D,num:t.totalPollsCreated.totalNumber,title:"My Total Polls",color:t.totalPollsCreated.growth?"green":"red",progress:t.totalPollsCreated.growthPercentage,indicator:t.totalPollsCreated.growth?x:f,className:"w-full"}),e.jsx(u,{img:M,num:t.lifetimeVotes.totalNumber,title:"My Total Votes",color:t.lifetimeVotes.growth?"green":"red",progress:t.lifetimeVotes.growthPercentage,indicator:t.lifetimeVotes.growth?x:f,className:"w-full"})]})]}),e.jsxs("div",{className:"flex gap-6 sm:gap-9 lg:gap-12 w-full mt-6 sm:mt-9 lg:mt-12 xl:flex-row flex-col pb-5 sm:pb-0",children:[e.jsx(U,{userId:o,userName:l.name}),e.jsx(V,{userId:o,userName:l.name})]})]})};export{B as default};
