import{j as e,r as c,U as b,L as d}from"./index-395cc95b.js";import{L as y}from"./SpinLoader-aa9ba6ba.js";import{C as N,a as C,L as P,P as E,B as T,p as V,b as D,c as L,w as k,d as S,e as $,f as A}from"./index-ded1588e.js";import{u as B}from"./useMediaQuery-427bbe76.js";import{s as f}from"./styles-12bc90a9.js";import{C as p,p as M,i as g,d as w,v as _}from"./index-652582aa.js";import{E as U}from"./index-e92b4352.js";N.register(C,P,E,T,V,D,L);const O=({data:o,label:t,title:a,footer:m,xAxisTitle:r,yAxisTitle:i,borderColor:x="rgba(75, 192, 192, 1)",backgroundColor:h="rgba(75, 192, 192, 0.2)"})=>{const l=B("(max-width: 500px)"),n={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:a,text:a},tooltip:{callbacks:{footer:m}}},interaction:{mode:"nearest",intersect:!1,axis:"x"},scales:{x:{display:!0,title:{display:!0,text:r},ticks:{autoSkip:!1,callback:function(s){return $(this.getLabelForValue(s),l?7:15)}}},y:{display:!0,title:{display:!0,text:i},ticks:{beginAtZero:!0,callback:function(s){if(s%1===0&&s>0)return s}}}}},j={labels:o.map((s,v)=>k(s.label,l?45:60)||v),datasets:[{label:t,data:o.map(s=>s.count),borderColor:x,backgroundColor:h,borderWidth:1}]};return e.jsx(S,{options:n,data:j})},u=({num:o,title:t,color:a,className:m})=>{const r={border:`1px solid ${a||"#D4B000"}`},i={background:`${a||"#D4B000"}`};return e.jsxs("div",{className:`bg-white py-2 pl-5 sm:py-6 px-4 rounded-lg relative overflow-hidden ${m}`,style:r,children:[e.jsx("div",{className:"h-full w-2 absolute top-0 left-0",style:i}),e.jsxs("h6",{className:` ${f.heading6} whitespace-nowrap`,children:["My Total ",t]}),e.jsx("h1",{className:`${f.heading3} font-semibold`,children:o})]})};const R="http://localhost:5000/api/v1",z=()=>{const{userInfo:o}=c.useContext(b),[t,a]=c.useState(null),[m,r]=c.useState(!0),[i,x]=c.useState(null),h=async()=>{x(null),r(!0);try{const l=await fetch(`${R}/user/dashboard/${o._id}`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}),n=await l.json();if(l.ok)a(n),r(!1);else throw new Error((n==null?void 0:n.message)||"error while fetching the dashoard")}catch(l){console.log("Error while getting your dashboard",l),x(l.message)}};return c.useEffect(()=>{h()},[]),c.useEffect(()=>{console.log(t==null?void 0:t.voteChartData)},[t]),m?e.jsx("div",{className:"flex justify-center",children:e.jsx(y,{})}):i?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(U,{heading:"Error fetching the dashoard",message:i,action:h})}):e.jsxs("div",{className:"py-5 sm:py-0 overflow-x-hidden",children:[e.jsx("h1",{className:`${f.heading2} mb-5`,children:"Polls Overview"}),e.jsxs("div",{className:"flex flex-col justify-between xl:flex-row items-center gap-5",children:[e.jsxs("div",{className:"w-full xl:w-auto",children:[e.jsxs("div",{className:"flex sm:flex-col md:flex-row gap-5 mb-6",children:[e.jsx(d,{to:"/poll/my-poll",state:{active:"active"},className:"w-full",children:e.jsx(u,{num:t.activePolls,title:"Active Polls",color:"green"})}),e.jsx(d,{to:"/poll/my-poll",state:{active:"closed"},className:"w-full",children:e.jsx(u,{num:t.totalPollsCreated.totalNumber-t.activePolls,title:"Closed Polls",color:"red"})})]}),e.jsx(d,{to:"/poll/my-poll",state:{active:"all"},className:"w-full",children:e.jsx(p,{img:M,num:t.totalPollsCreated.totalNumber,title:"Total Polls",color:t.totalPollsCreated.growth?"green":"red",progress:t.totalPollsCreated.growthPercentage,indicator:t.totalPollsCreated.growth?g:w})})]}),e.jsx("div",{className:"w-full flex-grow h-80 flex items-center justify-center p-4 rounded-lg shadow-md bg-white",children:e.jsx("div",{className:"w-60 sm:w-80 md:w-96 flex-grow h-full",children:e.jsx(O,{data:t.pollChartData,label:"Total Polls",xAxisTitle:"Date",yAxisTitle:"Number of polls created"})})})]}),e.jsx("h1",{className:`${f.heading2} my-5`,children:"Votes Overview"}),e.jsxs("div",{className:"flex flex-col justify-between xl:flex-row items-center gap-5",children:[e.jsxs("div",{className:"w-full xl:w-auto",children:[e.jsxs("div",{className:"flex sm:flex-col md:flex-row gap-5 mb-5",children:[e.jsx(d,{to:"/poll/my-vote",state:{active:"active"},className:"w-full",children:e.jsx(u,{num:t.activePollVotes,title:"Active Votes",color:"green"})}),e.jsx(d,{to:"/poll/my-vote",state:{active:"closed"},className:"w-full",children:e.jsx(u,{num:t.lifetimeVotes.totalNumber-t.activePollVotes,title:"Closed Vote",color:"red"})})]}),e.jsx(d,{to:"/poll/my-vote",state:{active:"all"},className:"w-full",children:e.jsx(p,{img:_,num:t.lifetimeVotes.totalNumber,title:"Total Votes",color:t.lifetimeVotes.growth?"green":"red",progress:t.lifetimeVotes.growthPercentage,indicator:t.lifetimeVotes.growth?g:w})})]}),e.jsx("div",{className:"w-full flex-grow h-80 flex items-center justify-center p-4 rounded-lg shadow-md bg-white",children:e.jsx("div",{className:"w-60 sm:w-80 md:w-96 flex-grow h-full",children:e.jsx(A,{data:t.voteChartData,label:"Total Vote",xAxisTitle:"Dates",yAxisTitle:"Number of votes done by me"})})})]})]})};export{z as default};
